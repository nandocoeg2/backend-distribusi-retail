{"level":"error","message":"Failed to start server: Cannot read properties of undefined (reading 'error')","service":"user-service","stack":"TypeError: Cannot read properties of undefined (reading 'error')\n    at connectDatabase (D:\\Project\\backend-distribusi-retail\\src\\config\\database.ts:45:12)\n    at start (D:\\Project\\backend-distribusi-retail\\src\\index.ts:13:5)","timestamp":"2025-08-16T04:29:43.346Z"}
{"level":"error","message":"Failed to start server: Cannot read properties of undefined (reading 'error')","service":"user-service","stack":"TypeError: Cannot read properties of undefined (reading 'error')\n    at connectDatabase (D:\\Project\\backend-distribusi-retail\\src\\config\\database.ts:45:12)\n    at start (D:\\Project\\backend-distribusi-retail\\src\\index.ts:13:5)","timestamp":"2025-08-16T04:30:55.444Z"}
{"level":"error","message":"Failed to start server: Cannot read properties of undefined (reading 'error')","service":"user-service","stack":"TypeError: Cannot read properties of undefined (reading 'error')\n    at connectDatabase (D:\\Project\\backend-distribusi-retail\\src\\config\\database.ts:45:12)\n    at start (D:\\Project\\backend-distribusi-retail\\src\\index.ts:13:5)","timestamp":"2025-08-16T04:32:23.070Z"}
{"code":"FST_ERR_PLUGIN_VERSION_MISMATCH","level":"error","message":"fastify-plugin: @fastify/cookie - expected '5.x' fastify version, '4.29.1' is installed","name":"FastifyError","service":"user-service","stack":"FastifyError: fastify-plugin: @fastify/cookie - expected '5.x' fastify version, '4.29.1' is installed\n    at Object.checkVersion (D:\\Project\\backend-distribusi-retail\\node_modules\\fastify\\lib\\pluginUtils.js:125:11)\n    at Object.registerPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\fastify\\lib\\pluginUtils.js:148:16)\n    at Boot.override (D:\\Project\\backend-distribusi-retail\\node_modules\\fastify\\lib\\pluginOverride.js:28:57)\n    at Boot._loadPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:425:25)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":500,"timestamp":"2025-08-16T06:28:13.583Z"}
{"level":"error","message":"\nInvalid `prisma.session.create()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\utils\\jwt.utils.ts:34:24\n\n  31 \n  32 const expiresAt = new Date(Date.now() + parseInt(JWT_REFRESH_EXPIRES_IN, 10) * 1000);\n  33 \n→ 34 await prisma.session.create(\nForeign key constraint violated: `sessions_userId_fkey (index)`","service":"user-service","target":"session.create","timestamp":"2025-08-16T06:59:21.676Z"}
{"level":"error","message":"\nInvalid `prisma.session.create()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\utils\\jwt.utils.ts:34:24\n\n  31 \n  32 const expiresAt = new Date(Date.now() + parseInt(JWT_REFRESH_EXPIRES_IN, 10) * 1000);\n  33 \n→ 34 await prisma.session.create(\nUnique constraint failed on the fields: (`refreshToken`)","service":"user-service","target":"session.create","timestamp":"2025-08-16T07:48:39.944Z"}
{"level":"error","message":"\nInvalid `prisma.session.create()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\utils\\jwt.utils.ts:34:24\n\n  31 \n  32 const expiresAt = new Date(Date.now() + parseInt(JWT_REFRESH_EXPIRES_IN, 10) * 1000);\n  33 \n→ 34 await prisma.session.create(\nUnique constraint failed on the fields: (`refreshToken`)","service":"user-service","target":"session.create","timestamp":"2025-08-16T07:48:40.959Z"}
{"level":"error","message":"\nInvalid `prisma.session.create()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\utils\\jwt.utils.ts:34:24\n\n  31 \n  32 const expiresAt = new Date(Date.now() + parseInt(JWT_REFRESH_EXPIRES_IN, 10) * 1000);\n  33 \n→ 34 await prisma.session.create(\nUnique constraint failed on the fields: (`refreshToken`)","service":"user-service","target":"session.create","timestamp":"2025-08-16T07:48:50.937Z"}
{"level":"error","message":"\nInvalid `prisma.user.create()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:22:36\n\n  19 \n  20 const hashedPassword = await hashPassword(input.password);\n  21 \n→ 22 const user = await prisma.user.create({\n       data: {\n         email: \"test@example.com\",\n         username: \"example test\",\n         firstName: \"example\",\n         lastName: \"testr\",\n         password: \"$2b$10$geN1D2JTTEisT8A97OEbMOinDaOi2KAk/bTM.05LGHAYIh6w8UQmi\",\n     +   role: {\n     +     create: RoleCreateWithoutUsersInput | RoleUncheckedCreateWithoutUsersInput,\n     +     connectOrCreate: RoleCreateOrConnectWithoutUsersInput,\n     +     connect: RoleWhereUniqueInput\n     +   }\n       }\n     })\n\nArgument `role` is missing.","service":"user-service","target":"user.create","timestamp":"2025-08-17T12:43:41.671Z"}
{"address":"::1","code":"EADDRINUSE","errno":-4091,"level":"error","message":"Failed to start server: listen EADDRINUSE: address already in use ::1:3000","port":3000,"service":"user-service","stack":"Error: listen EADDRINUSE: address already in use ::1:3000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at GetAddrInfoReqWrap.callback (node:net:2206:7)\n    at GetAddrInfoReqWrap.onlookupall [as oncomplete] (node:dns:134:8)","syscall":"listen","timestamp":"2025-08-17T12:44:57.577Z"}
{"code":"AVV_ERR_PLUGIN_NOT_VALID","level":"error","message":"Plugin must be a function or a promise. Received: 'undefined'","name":"FastifyError","service":"user-service","stack":"FastifyError: Plugin must be a function or a promise. Received: 'undefined'\n    at validatePlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\validate-plugin.js:19:13)\n    at Boot._addPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:166:3)\n    at Boot.use (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:139:25)\n    at Object.server.<computed> [as register] (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:213:14)\n    at exports.default (D:\\Project\\backend-distribusi-retail\\src\\routes\\index.ts:8:11)\n    at Plugin.exec (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\plugin.js:125:28)\n    at Boot._loadPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:432:10)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":500,"timestamp":"2025-08-17T12:45:38.149Z"}
{"code":"AVV_ERR_PLUGIN_NOT_VALID","level":"error","message":"Plugin must be a function or a promise. Received: 'undefined'","name":"FastifyError","service":"user-service","stack":"FastifyError: Plugin must be a function or a promise. Received: 'undefined'\n    at validatePlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\validate-plugin.js:19:13)\n    at Boot._addPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:166:3)\n    at Boot.use (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:139:25)\n    at Object.server.<computed> [as register] (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:213:14)\n    at exports.default (D:\\Project\\backend-distribusi-retail\\src\\routes\\index.ts:8:11)\n    at Plugin.exec (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\plugin.js:125:28)\n    at Boot._loadPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:432:10)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":500,"timestamp":"2025-08-17T12:45:59.395Z"}
{"code":"AVV_ERR_PLUGIN_NOT_VALID","level":"error","message":"Plugin must be a function or a promise. Received: 'undefined'","name":"FastifyError","service":"user-service","stack":"FastifyError: Plugin must be a function or a promise. Received: 'undefined'\n    at validatePlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\validate-plugin.js:19:13)\n    at Boot._addPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:166:3)\n    at Boot.use (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:139:25)\n    at Object.server.<computed> [as register] (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:213:14)\n    at exports.default (D:\\Project\\backend-distribusi-retail\\src\\routes\\index.ts:8:11)\n    at Plugin.exec (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\plugin.js:125:28)\n    at Boot._loadPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:432:10)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":500,"timestamp":"2025-08-17T12:46:35.204Z"}
{"code":"AVV_ERR_PLUGIN_NOT_VALID","level":"error","message":"Plugin must be a function or a promise. Received: 'undefined'","name":"FastifyError","service":"user-service","stack":"FastifyError: Plugin must be a function or a promise. Received: 'undefined'\n    at validatePlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\validate-plugin.js:19:13)\n    at Boot._addPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:166:3)\n    at Boot.use (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:139:25)\n    at Object.server.<computed> [as register] (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:213:14)\n    at exports.default (D:\\Project\\backend-distribusi-retail\\src\\routes\\index.ts:8:11)\n    at Plugin.exec (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\plugin.js:125:28)\n    at Boot._loadPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:432:10)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":500,"timestamp":"2025-08-17T12:47:29.266Z"}
{"code":"AVV_ERR_PLUGIN_NOT_VALID","level":"error","message":"Plugin must be a function or a promise. Received: 'undefined'","name":"FastifyError","service":"user-service","stack":"FastifyError: Plugin must be a function or a promise. Received: 'undefined'\n    at validatePlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\validate-plugin.js:19:13)\n    at Boot._addPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:166:3)\n    at Boot.use (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:139:25)\n    at Object.server.<computed> [as register] (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:213:14)\n    at exports.default (D:\\Project\\backend-distribusi-retail\\src\\routes\\index.ts:8:11)\n    at Plugin.exec (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\lib\\plugin.js:125:28)\n    at Boot._loadPlugin (D:\\Project\\backend-distribusi-retail\\node_modules\\avvio\\boot.js:432:10)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)","statusCode":500,"timestamp":"2025-08-17T12:47:49.495Z"}
{"address":"::1","code":"EADDRINUSE","errno":-4091,"level":"error","message":"Failed to start server: listen EADDRINUSE: address already in use ::1:3000","port":3000,"service":"user-service","stack":"Error: listen EADDRINUSE: address already in use ::1:3000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at GetAddrInfoReqWrap.callback (node:net:2206:7)\n    at GetAddrInfoReqWrap.onlookupall [as oncomplete] (node:dns:134:8)","syscall":"listen","timestamp":"2025-08-17T12:49:14.421Z"}
{"address":"::1","code":"EADDRINUSE","errno":-4091,"level":"error","message":"Failed to start server: listen EADDRINUSE: address already in use ::1:3000","port":3000,"service":"user-service","stack":"Error: listen EADDRINUSE: address already in use ::1:3000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at GetAddrInfoReqWrap.callback (node:net:2206:7)\n    at GetAddrInfoReqWrap.onlookupall [as oncomplete] (node:dns:134:8)","syscall":"listen","timestamp":"2025-08-17T12:56:36.362Z"}
{"level":"error","message":"\nInvalid `prisma.user.findUnique()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:52:36\n\n  49 static async login(\n  50   input: LoginInput\n  51 ): Promise<{ accessToken: string; refreshToken: string; user: any }> {\n→ 52   const user = await prisma.user.findUnique({\n         where: {\n           email: \"test@example.com\"\n         },\n         include: {\n           role: {\n             include: {\n               roleMenus: {\n               ~~~~~~~~~\n                 include: {\n                   menu: true\n                 },\n                 orderBy: {\n                   menu: {\n                     order: \"asc\"\n                   }\n                 }\n               },\n       ?       users?: true,\n       ?       menus?: true\n             }\n           }\n         }\n       })\n\nUnknown field `roleMenus` for include statement on model `Role`. Available options are marked with ?.","service":"user-service","target":"user.findUnique","timestamp":"2025-08-17T12:57:16.498Z"}
{"level":"error","message":"\nInvalid `prisma.user.findUnique()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:52:36\n\n  49 static async login(\n  50   input: LoginInput\n  51 ): Promise<{ accessToken: string; refreshToken: string; user: any }> {\n→ 52   const user = await prisma.user.findUnique({\n         where: {\n           email: \"test@example.com\"\n         },\n         include: {\n           role: {\n             include: {\n               roleMenus: {\n               ~~~~~~~~~\n                 include: {\n                   menu: true\n                 },\n                 orderBy: {\n                   menu: {\n                     order: \"asc\"\n                   }\n                 }\n               },\n       ?       users?: true,\n       ?       menus?: true\n             }\n           }\n         }\n       })\n\nUnknown field `roleMenus` for include statement on model `Role`. Available options are marked with ?.","service":"user-service","target":"user.findUnique","timestamp":"2025-08-17T12:57:17.457Z"}
{"level":"error","message":"\nInvalid `prisma.user.findUnique()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:52:36\n\n  49 static async login(\n  50   input: LoginInput\n  51 ): Promise<{ accessToken: string; refreshToken: string; user: any }> {\n→ 52   const user = await prisma.user.findUnique({\n         where: {\n           email: \"test@example.com\"\n         },\n         include: {\n           role: {\n             include: {\n               roleMenus: {\n               ~~~~~~~~~\n                 include: {\n                   menu: true\n                 },\n                 orderBy: {\n                   menu: {\n                     order: \"asc\"\n                   }\n                 }\n               },\n       ?       users?: true,\n       ?       menus?: true\n             }\n           }\n         }\n       })\n\nUnknown field `roleMenus` for include statement on model `Role`. Available options are marked with ?.","service":"user-service","target":"user.findUnique","timestamp":"2025-08-17T12:57:17.995Z"}
{"level":"error","message":"\nInvalid `prisma.user.findUnique()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:52:36\n\n  49 static async login(\n  50   input: LoginInput\n  51 ): Promise<{ accessToken: string; refreshToken: string; user: any }> {\n→ 52   const user = await prisma.user.findUnique({\n         where: {\n           email: \"test@example.com\"\n         },\n         include: {\n           role: {\n             include: {\n               menus: {\n                 include: {\n                   menu: true\n                 },\n                 orderBy: {\n                   menu: {\n                     order: \"asc\",\n                     ~~~~~\n       ?             id?: SortOrder,\n       ?             name?: SortOrder,\n       ?             url?: SortOrder,\n       ?             icon?: SortOrder | SortOrderInput,\n       ?             parentId?: SortOrder | SortOrderInput,\n       ?             parent?: MenuOrderByWithRelationInput,\n       ?             children?: MenuOrderByRelationAggregateInput,\n       ?             roles?: RoleMenuOrderByRelationAggregateInput\n                   }\n                 }\n               }\n             }\n           }\n         }\n       })\n\nUnknown argument `order`. Available options are marked with ?.","service":"user-service","target":"user.findUnique","timestamp":"2025-08-17T12:58:28.816Z"}
{"level":"error","message":"\nInvalid `prisma.user.findUnique()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:52:36\n\n  49 static async login(\n  50   input: LoginInput\n  51 ): Promise<{ accessToken: string; refreshToken: string; user: any }> {\n→ 52   const user = await prisma.user.findUnique({\n         where: {\n           email: \"test@example.com\"\n         },\n         include: {\n           role: {\n             include: {\n               menus: {\n                 include: {\n                   menu: true\n                 },\n                 orderBy: {\n                   menu: {\n                     order: \"asc\",\n                     ~~~~~\n       ?             id?: SortOrder,\n       ?             name?: SortOrder,\n       ?             url?: SortOrder,\n       ?             icon?: SortOrder | SortOrderInput,\n       ?             parentId?: SortOrder | SortOrderInput,\n       ?             parent?: MenuOrderByWithRelationInput,\n       ?             children?: MenuOrderByRelationAggregateInput,\n       ?             roles?: RoleMenuOrderByRelationAggregateInput\n                   }\n                 }\n               }\n             }\n           }\n         }\n       })\n\nUnknown argument `order`. Available options are marked with ?.","service":"user-service","target":"user.findUnique","timestamp":"2025-08-17T12:58:29.424Z"}
{"level":"error","message":"\nInvalid `prisma.user.findUnique()` invocation in\nD:\\Project\\backend-distribusi-retail\\src\\services\\auth.service.ts:52:36\n\n  49 static async login(\n  50   input: LoginInput\n  51 ): Promise<{ accessToken: string; refreshToken: string; user: any }> {\n→ 52   const user = await prisma.user.findUnique({\n         where: {\n           email: \"test@example.com\"\n         },\n         include: {\n           role: {\n             include: {\n               menus: {\n                 include: {\n                   menu: true\n                 },\n                 orderBy: {\n                   menu: {\n                     order: \"asc\",\n                     ~~~~~\n       ?             id?: SortOrder,\n       ?             name?: SortOrder,\n       ?             url?: SortOrder,\n       ?             icon?: SortOrder | SortOrderInput,\n       ?             parentId?: SortOrder | SortOrderInput,\n       ?             parent?: MenuOrderByWithRelationInput,\n       ?             children?: MenuOrderByRelationAggregateInput,\n       ?             roles?: RoleMenuOrderByRelationAggregateInput\n                   }\n                 }\n               }\n             }\n           }\n         }\n       })\n\nUnknown argument `order`. Available options are marked with ?.","service":"user-service","target":"user.findUnique","timestamp":"2025-08-17T12:58:29.987Z"}
{"address":"::1","code":"EADDRINUSE","errno":-4091,"level":"error","message":"Failed to start server: listen EADDRINUSE: address already in use ::1:3000","port":3000,"service":"user-service","stack":"Error: listen EADDRINUSE: address already in use ::1:3000\n    at Server.setupListenHandle [as _listen2] (node:net:1940:16)\n    at listenInCluster (node:net:1997:12)\n    at GetAddrInfoReqWrap.callback (node:net:2206:7)\n    at GetAddrInfoReqWrap.onlookupall [as oncomplete] (node:dns:134:8)","syscall":"listen","timestamp":"2025-08-17T12:58:31.482Z"}
